# Overview

## Что такое Helm

Helm — это менеджер пакетов и шаблонизатор для Kubernetes, который позволяет упаковывать набор манифестов в единый логический пакет и управлять им как «приложением».  
Если проводить аналогии, Kubernetes — это «операционная система», а Helm — её пакетный менеджер вроде `apt` или `yum`, но заточенный на деплой и обновление ресурсов кластера.

Основная задача Helm — убрать боль от десятков/сотен YAML‑файлов, дублирования и ручного копирования/вставки.  
Вместо этого создаётся чарт с шаблонами и значениями (values), а потом Helm сам рендерит и применяет манифесты.

---

## Чем Helm помогает по сравнению с «голыми» манифестами

### Меньше дублирования и копипасты

Без Helm:

- Под каждый сервис и окружение (dev/stage/prod) часто держат отдельные YAML‑файлы, отличающиеся только парой полей.  
- Любое изменение (например, новый label или env) нужно протаскивать руками во все файлы.

С Helm:

- Есть шаблоны (`templates/`), в которые подставляются значения из `values.yaml`.  
- Для разных окружений меняются только values, а шаблоны остаются общими.  
- Один и тот же чарт можно переиспользовать десятки раз с разными параметрами.

### Управление версиями и релизами

Без Helm:

- Применение `kubectl apply -f` не хранит историю на уровне «релизов» приложения.  
- Откат — это попытка найти предыдущую версию манифестов и снова их применить.

С Helm:

- Каждый запуск `helm install`/`helm upgrade` создаёт/изменяет **release**, у которого есть версия и история.  
- Можно посмотреть список установленных релизов и их ревизии, откатиться назад одной командой (`helm rollback`).  
- Становится проще делать контролируемые релизы и откаты.

### Простая установка и распространение приложений

Без Helm:

- Чтобы отдать кому‑то своё приложение под Kubernetes, нужно шарить набор YAML‑файлов, а пользователь сам разбирается, как их применять и настраивать.

С Helm:

- Приложение упаковано в **chart**, который можно положить в репозиторий.  
- Установка сводится к команде `helm install` с нужными values; обновление — к `helm upgrade`.  
- Это удобно как для внутренних чартов (ваши сервисы), так и для сторонних решений (PostgreSQL, Redis, Prometheus, ingress‑контроллеры и т.п.).

---

## Базовые сущности: chart, release, repository

### Chart

**Chart** — это пакет Helm, описывающий приложение или компонент инфраструктуры для Kubernetes.

В нём обычно есть:

- `Chart.yaml` — метаданные (имя, версия, описание, зависимости).  
- `values.yaml` — значения по умолчанию (репликасы, ресурсы, image, env, конфиги и т.д.).  
- `templates/` — шаблоны Kubernetes‑манифестов (Deployment, Service, Ingress, ConfigMap, Secret, Job и т.п.).  
- дополнительные файлы: `_helpers.tpl`, `values-*.yaml`, `charts/` (subcharts), тесты.

Чарт можно:

- хранить в Git;  
- упаковать (`helm package`) и положить в репозиторий;  
- использовать многократно в разных кластерах и окружениях.

### Release

**Release** — это конкретный установленный экземпляр чарта в кластере.

Особенности:

- Один и тот же chart может быть установлен несколько раз с разными именами релиза и разными values (например, `myapp-dev`, `myapp-prod`).  
- Каждое обновление через `helm upgrade` создаёт новую ревизию релиза.  
- Информация о релизе (его ревизиях, values, статусе) хранится в кластере, и Helm может по ней делать `upgrade`, `rollback`, `uninstall`.

Практически:

- chart — это «шаблон приложения»;  
- release — «конкретный установленный экземпляр этого шаблона» в кластере.

### Repository

**Repository (репозиторий чартов)** — это место, где публикуются и откуда скачиваются чарты.

Особенности:

- Репозиторий — это HTTP‑хранилище с индексом (`index.yaml`) и архивами чартов (`.tgz`).  
- Есть публичные репозитории (официальные, community, вендоры) и приватные (внутри компании).  
- Helm может:

  - добавить репозиторий (`helm repo add`),  
  - обновить его индекс (`helm repo update`),  
  - искать чарты (`helm search repo`),  
  - скачивать чарты (`helm pull`).

Репозитории позволяют:

- стандартизировать набор чартов по компании;  
- чётко версионировать и распространять инфраструктурные/приложенческие пакеты;  
- интегрировать установку/обновление в CI/CD.

---

## Где Helm особенно полезен

- Микросервисная архитектура, где много сервисов и окружений, и руками поддерживать YAML становится невозможно.  
- Продуктовые команды, которым нужно быстро и одинаково поднимать стенды.  
- Доставка стороннего ПО (БД, брокеры, мониторинг, логирование) в виде готовых чартов.  
- Организации, где важны предсказуемые релизы, повторяемость и возможность быстрых откатов.  